<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Grand Café Concierge</title>
    <script src="https://cdn.platform.openai.com/deployments/chatkit/chatkit.js"></script>
    <style>
        body, html { 
            margin: 0; padding: 0; 
            height: 100%; width: 100%; 
            background-color: #FEF9EE; /* Brand Beige */
            overflow: hidden;
        }
        /* Ensure the chat component fills the window */
        openai-chatkit { height: 100vh; width: 100vw; }
    </style>
</head>
<body>
    <script>
        const TOKEN_URL = "/api/token"; 

        async function init() {
            // 1. Wait for the component to be ready
            await customElements.whenDefined('openai-chatkit');
            
            // 2. Create the Chat Element
            const chat = document.createElement('openai-chatkit');
            
            // 3. Configure it
            chat.setOptions({
                api: {
                    // Fetch the token from your now-working backend
                    getClientSecret: async () => {
                        const res = await fetch(TOKEN_URL, { method: 'POST' });
                        const data = await res.json();
                        return data.client_secret;
                    }
                },
                theme: 'light',
                header: {
                    title: 'Grand Café Concierge',
                    style: { backgroundColor: '#FEF9EE', color: '#978550', borderBottom: '1px solid #978550' }
                },
                style: {
                    // Custom Branding Colors
                    '--ck-body-background': '#FEF9EE',
                    '--ck-message-user-background': '#978550',
                    '--ck-primary-text': '#978550',
                    '--ck-secondary-text': '#5a5a5a',
                    '--ck-border-radius': '8px',
                }
            });

            // 4. Add to screen
            document.body.appendChild(chat);
        }
        
        // Start
        init();
    </script>
</body>
</html>
